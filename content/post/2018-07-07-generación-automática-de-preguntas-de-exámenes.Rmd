---
title: Generación automática de preguntas de Estadística
author: Matías A. Alfonso
date: '2018-07-07'
slug: generación-automática-de-preguntas-de-exámenes
categories:
  - R
tags:
  - e-learning
  - r-exams
  - estadistica
---
Uno de las tareas a las que nos enfrentamos los docentes es el diseño y la implementación de exámenes de evaluación. En esta dirección, conjuntamente con el Dr. Eduardo Bologna venimos trabajando en un sistema de generación de preguntas de exámenes de estadística, el cual hemos comenzado a implementar progresivamente en la cátedra de Psicoestadística de la Facultad de Psicología de la Universidad Nacional de Córdoba.  



El sistema de generación de preguntas está basado en [r-exams](http://www.r-exams.org/), una librería de [R](https://www.r-project.org/) open-source que permite elaborar diferentes [tipos de preguntas](http://www.r-exams.org/intro/dynamic/) y a partir de ella, generar exámenes para varios sistemas: [exámenes escritos](http://www.r-exams.org/intro/written/) PDF (con evaluación automática), exámenes para importar en diversas [plataformas de aprendizaje](http://www.r-exams.org/intro/elearning/) (Moodle, Blackboard, OLAT, Ilias) así como la posibilidad de crear salidas personalizadas (PDF, HTML, doc). Para generar las preguntas, `rexams` permite utilizar las sintaxis de `rmarkdown` o `sweave`. 

Hemos creado un [proyecto](https://github.com/mentoldo/exam_stat), open source, con dos objetivos principales. Por un lado, generar una base de preguntas dinámicas de acceso libre. Por el otro, generar una sistema de clasificación de estas preguntas, en relación a dificultad, contenidos teóricos y procesos psicológicos involucrados en su resolución.
Hasta el momento hemos creado 18 preguntas **single choice** con cuatro opciones de respuesta. La carpeta preguntas contiene un archivo por cada pregunta generada. Además en el proyecto, se encuentra una archivo *README.md* con especificaciones y documentación

## Instructivo

Para utilizar la base de preguntas es necesarios tener instalado R. Además, en este instructivo, utilizaremos [RStudio](https://www.rstudio.com/) para generar los exámenes de ejemplo.
Primero instalaremos el paquete `rexams`:

```{r rexams, eval = FALSE}

install.packages("rexams")

```

`rexams` instalará automáticamente la mayoría de las dependencias necesarias para su utilización. Sin embargo, si alguna dependencia no está satisfecha, deberemos instalarla también. En el caso que querramos generar un examen escrito, también tendremos que tener instalado [Latex](https://www.latex-project.org/get/) en nuestra computadora.  
Una vez instaladas las dependencias, procederemos a descargar el [proyecto](https://github.com/mentoldo/exam_stat), haciendo click en clone or download, o, si preferimos la consola:

```git
git clone https://github.com/mentoldo/exam_stat
```
Si utilizamos RStudio, podremos abrir el proyecto directamente desde el archivo *exam_stat.Rproj*. Esto configurará automáticamente el directorio de trabajo en la carpeta donde se encuentra el proyecto. En el caso contrarió deberemos indicar el directorio de trabajo:
```r
setwd("PATCH/A/PROYECTO")
```

## Moodle

Abrimos el script *hacerExamenMoodle.R* y cargamos la librería `rexams`

```r
file.edit("hacerExamenMoodle.R")
```

Vamos a generar 100 preguntas aleatorias de *P_boxplot2.Rmd*.

```r
## El argumento rule = "none" permite que las respuestas erradas no resten puntos
## Hacer R2018_0004
exams2moodle("./preguntas/html/P_boxplot2.Rmd",
             n = 100,
             name = "R2018_0004",
             rule = "none",
             dir = "moodle")
```
Este código nos generará 100 preguntas diferentes listas para importar en moodle en el archivo *./moodle/Pboxplot2.xml*. Si queremos generar todas las preguntas disponibles en el proyecto, podremos ejecutar el resto del script.

```r
## Creamos una función para exportar las preguntas
preg <- list.files("./preguntas/html", full.names = TRUE)

exportar <- function(x) {
    exams2moodle(x,
                 n = 100, # La cantidad de preguntas
                 name = gsub("./preguntas/html/|.Rmd", "", x), # Construye el nombre a partir del nombre original
                 rule = "none", # El argumento rule = "none" permite que las respuestas erradas no resten puntos
                 dir = "moodle") # Manda la salida a la carpeta moodle
}

## Exportamos todas las preguntas
lapply(preg, exportar)
```
Ahora tendremos todas las preguntas que se encuentran en *preguntas/* convertidas en archivos *.xml* listos para importar en Moodle.

## Exámen escrito

Veamos como generar un exámen escrito.

```r
file.edit("ejemplosencilloNops.R")
```

A modo de mostrar cómo pueden variar las preguntas, generaremos un exámen con una sola pregunta, con componentes aleatorios, repetida 30 veces.

```r
prueba <- exams2nops(rep("preguntas/latex/R2018_0015_L.Rmd", 30),
                      n = 1,
                      dir = "./examenes/ejemplosencillo/", 
                      name = "2018_formaA",
                      title = "Ejemplo",
                      institution = "Universidad Nacional de Córdoba",
                      logo = "/img/logo_UNC_2.png",
                      date = "2018-07-07",
                      language = "es",
                      blank = 0,
                      usepackage = c("inputenc", "booktabs", "longtable"),
                      encoding = "utf-8",
                      reglength = 8)
```

La función `exams2nops` tiene una gran cantidad de argumentos que podremos modificar para ajustar a nuestras necesidades. Podemos observar que en el argumento logo se debe indicar el patch absoluto de la ubicación de la imagen.  
Veamos ahora como generar un examen completo con 10 preguntas, eligiendo al azar entre las preguntas disponibles.

```r
file.edit("hacerExamenNops.R")
```

Lo primero que haremos será listar todas las preguntas existentes. Para ello, he creado una función llamada `listarpreguntas` que hace ese trabajo. Cargamos la funcion y colocamos el listado de preguntas en una variable

```r
source("listarpreguntas.R") ## la funcion listar preguntas lista todas
## las preguntas para formato PDF

preguntas <- listarpreguntas()
```

En general, cuando utilizamos generación de datos aleatorios, es una buena costumbre utilizar la función `set.seed`, pues esto nos permitirá reproducir exactamente los mismos resultados. Esto podría ayudarnos por ejemplo a solucionar un problema o un error con una pregunta específica.

```r
set.seed(-605196)
```

Del listado total de preguntas, seleccionaremos 10 al azar para la forma A, y 10 al azar para la forma B.

```r
muestraA <- sample(preguntas, 10)
muestraB <- sample(preguntas, 10)
```

Una vez elegidas las preguntas de cada forma, ejecutamos la instrucción para generar los exámenes. Generaremos dos modelos diferentes para cada forma.

```r
## Forma A
pruebaA <- exams2nops(muestraA,
                      n = 2,
                      dir = "./examenes/ejemplo/", 
                      name = "2018_formaA",
                      title = "Estadística, Forma A",
                      institution = "Universidad Nacional de Córdoba",
                      logo = "img/logo_UNC_2.png",
                      date = "2018-07-07",
                      language = "es",
                      blank = 0,
                      usepackage = c("inputenc", "booktabs", "longtable"),
                      encoding = "utf-8",
                      reglength = 8)

## Forma B
pruebaB <- exams2nops(muestraB,
                      n = 2,
                      dir = "./examenes/ejemplo/", 
                      name = "2018_formaB",
                      title = "Estadística, Forma B",
                      institution = "Universidad Nacional de Córdoba",
                      logo = "img/logo_UNC_2.png",
                      date = "2018-07-07",
                      language = "es",
                      blank = 0,
                      usepackage = c("inputenc", "booktabs", "longtable"),
                      encoding = "utf-8",
                      reglength = 8)
```

Ahora tenemos los exámenes creados en formato PDF en la dirección indicada *./examenes/ejemplo*.  

Si estás interesado en este proyecto, podés enviarme un mail a matias.alfonso@gmail.com. Estimamos poder duplicar o triplicar la base de preguntas para fines de 2018. Algunos de los modos en los que podés colaborar son:  

* Indicando documentación incompleta o poco clara.  
* Identificando y reportando preguntas que tengan algún error.  
* Colaborando con la elaboración de preguntas nuevas.  
* Colaborando con la elaboración de un sistema de clasificación de las preguntas.